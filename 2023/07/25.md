#### 2023.7.25 | Authentication

JWT 토큰에는 Session 보다 많은 정보를 전송한다. JWT 방식의 장점은 Stateless 인데 회원이 많아질수록 서버에 덜 부담이 된다. 기존의 Session 방식은 회원이 인증을 요청할 때마다 Session Storage에서 해당 데이터를 조회해서 확인을 해야 하니깐 만약 동시 접속이 1억 명이 있다면 매우 힘들어질 수도 있다. JWT는 유저가 회원 인증을 요청할 때마다 해당 토큰만 검사하면 되니깐 처리가 매우 빨라진다. 하지만 JWT를 사용할 때는 다음과 같은 보안 이슈를 생각해야 한다. 

1. alg - none 공격: Header에 "alg": "none"으로 해서 JWT를 만들어 보내는 악성 유저들이 있다. 
2. JWT는 변환이 쉬움: JWT는 Decoding이 매우 쉽기 때문에 민감한 유저 정보를 그대로 넣으면 안된다. 
3. 시크릿키 문제: 시크릿키를 단순히 적어서 문제가 되는 서버들이 많다. 키를 길게 적고, 공유 금지, 생성용키/검정용키(private key + public key) 2개를 사용해서 엄격히 관리할 수도 있다.
4. JWT 탈취: HttpOnly cookie 같은 탈취가 어려운 저장소를 사용한다. JWT 블랙리스트 목록을 만들어서 특정 토큰으로는 접근이 불가능하는 것을 구현한다.(하지만 이렇게 사용하면 session 방식이랑 별 차이가 없다) JWT 유효기간을 짧게 한다. Refresh Token을 통한 토큰 재발급, 하지만 Refresh Token도 탈취당하는 경우들이 있어서 Refresh Token Rotation - Refresh Token을 재발급 요청을 하거나 재사용하는 걸 발견하게 되면 JWT 토큰을 발급해 주지 않는 것으로 항상 1회용으로만 사용해야 안전하게 사용할 수 있다. 