#### 2023.7.24 | DevOps

대용량 트래픽 처리

1. 서버를 수평 확장하거나 로드 밸런싱을 구성한다.

서버나 DB를 확장하거나 로드 밸런싱을 구성하여 트래픽을 분산시킨다. 

2. 캐시를 사용한다.

반복적인 요청을 처리하는 데 필요한 네트워크 시간이나 CPU 처리 등 리소스를 줄일 수 있다. 데이터가 캐시가 되면 요청이 왔을 때 빠르게 응답할 수 있으므로 응답 시간을 단축할 수 있다. In-Memory Cache(인-메모리 캐시)를 사용할 수도 있고 별도의 캐시 서버를 두고 연동할 수도 있다. In-Memory Cache의 단점은 데이터 크기에 제한이 있다. 별도 캐시 서버를 두면 구성은 복잡해지고 In-Memory Cache보다는 응답 시간이 느려지겠지만 그래도 많은 데이터를 캐싱 할 수 있다. 

3. CDN(Content Delivery Network)을 사용한다. 

콘텐츠를 여러 지역에 복제하여 지리적으로 분산을 시켜 지리적으로 떨어진 여러 사용자가 지역에서 가장 가까운 CDN 서버에 접속하여 데이터를 빨리 내려받을 수 있게 한다. 

4. 데이터베이스 최적화한다.
   
데이터베이스만 최적화해도 성능이 드라마틱 하게 개선될 수 있다. 인덱스를 추가하거나 쿼리를 최적화하는 튜닝을 통해서 작업을 수행할 수 있다. 

5. 캐싱 DNS 서버를 사용한다.

특정 서버에 도메인 이름으로 접속하려면 DNS 서버에 먼저 접속을 해서 연관된 IP를 받아와야 하는데 그 DNS 서버가 멀리 있으면 그만큼 시간이 오래 걸리기 때문에 가까운 위치에 DNS 정보를 캐시하고 있는 서버를 만든다. 그만큼의 DNS 조회 요청에 따른 시간이 줄어들면 응답 시간도 단축된다. 

6. 코드 최적화한다.

코드를 최적화하면 실행시간이 단축되고 서버가 처리할 수 있는 트래픽 양이 늘어난다. 

쓰레드 10개, 하나의 요청을 처리하는데 평균 0.05초 -> 200TPS
쓰레드 10개, 하나의 요청을 처리하는데 평균 0.02초 -> 500TPS

0.03초만 줄여도 TPS가 확 늘어난다. 하지만 너무 이른 최적화를 하는 것보다 필요한 곳에 최적화를 할 필요가 있다. 

- TPS Transactions Per Second의 약자로 초당 트랜잭션 수를 의미한다.
- 주요 성능 지표로는 응답 시간(Response Time), 처리량(Throughput), 실패율(Failure Rate)

추가로 서버나 사용 애플리케이션을 최신 버전을 업그레이드하거나 네트워크 대역폭을 늘리는 등의 방법이 있다.

하지만 이 모든 것들이 다 필요한 서비스는 많지 않다. 상황에 따라서 부분 적용하면 되다. 