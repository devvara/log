# 클로저(Closure)

클로저는 함수와 그 함수가 선언된 레시컬 환경(Lexical Envronment)과의 조합이다. 함수가 자신이 생성될 때의 환경을 '기억'하고, 이 환경에 있는 변수에 접근할 수 있도록 한다.

## 함수와 레시컬 스코프

자바스크립트의 함수는 각각 자신만의 스코프(유효 범위)가 있다. 함수 내에서 선언된 변수는 오직 그 함수 내에서만 접근 가능하다.

## 함수 밖에서도 내부 변수에 접근

일반적으로 함수 내부에서 선연된 변수는 그 함수의 실행이 끝나면 접근할 수 없게 된다. 그러나 클로저를 사용하면, 예외가 발생하고 함수 내부에서 다른 함수를 선언하고, 이 내부 함수가 외부 함수의 변수를 참조하게 되면, 외부 함수의 실행이 끝났더라도 내부 함수를 통해 그 변수에 계속 접근할 수 있다. 이 내부 함수가 바로 클로저이다.

````javascript
function createGreeting(greeting) {
  return function(name) {
    return greeting + ", " + name + "!";
  };
}

const sayHello = createGreeting("Hello");
const sayGoodbye = createGreeting("Goodbye);

console.log(sayHello("Sujin")); // "Hello, Sujin!"
console.log(sayGoodbye("Minzun")); // "Goodbye, Minzun!"
````

위 코드에서 `createGreeting` 함수는 문자열 `greeting`을 인자로 받고, 다른 함수를 반환한다. 반환된 함수는 `name`을 인자로 받아서 인사말을 완료한다. `createGreeting` 함수의 실행이 끝나고 반환된 함수(클로저)가 여전히 `greeting` 변수에 접근할 수 있다.

자바스크립트의 함수는 자신이 선언될 때의 환경을 기억한다. 이 환경에는 함수가 접근할 수 있는 모든 지역 변수가 포함되는데 `createGreeting` 함수의 실행이 끝나더라도, 그 함수에 의해 생성된 클로저는 `greeting` 변수에 대한 참조를 유지한다. 

클로저는 프로그램의 다른 부분에서 접근할 수 없는 변수에 접근할 수 있는 '비공개(private)' 변수와 같은 역할을 하기 때문에 데이터 캡슐화와 정보 은닉을 구현하는데 유용하다. 

## 클로저 사용 시점

- 데이터 캡슐화와 정보 은닉: 특정 데이터(변수)를 외부로부터 보호하고, 오직 특정 함수를 통해서 조작이 가능하도록 할 때
- 상태 유지: 함수가 호출될 때마다 이전 상태를 기억하여 상태 유지가 필요할 때
- 골백 함수와 함께 사용: 비동기 처리나 이벤트 처리에서 콜백 함수가 외부 함수의 변수를 계속 참조할 필요가 있을 때